
@{
    ViewBag.Title = "upload";
}

<canvas id='myCanvas' style='position:absolute; left:0px; top:0px;' />
<link href="~/Content/Style1.css" rel="stylesheet" type="text/css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<body>
    <script>
       var cnvs = document.getElementById('myCanvas');
       cnvs.width = window.innerWidth;
        cnvs.height = window.innerHeight;
        var ctx = cnvs.getContext('2d');
        var IntervalTime = @Session["time"] * 1000;
        var hasCircle = false;
        myTimer = (function () {
        $.post("@Url.Action("GetLine")").done(function (xml) {
        var lastLon;
            var lastLat;
            if (xml == "END") {
                clearInterval(interval);
                alert("End of Animation");
             
            }
        var xmlDoc = $.parseXML(xml),
            $xml = $(xmlDoc),
            lastLat = $xml.find("lastLat").text();
            lastLon = $xml.find("lastLon").text();
            Lat = $xml.find("Lat").text();
            Lon = $xml.find("Lon").text();
            if (!hasCircle) {
                ctx.strokeStyle = 'black';
                ctx.lineWidth = '4';
                ctx.strokeRect(0, 0, cnvs.width, cnvs.height);
                ctx.beginPath();
                ctx.arc(Lat, Lon, 6, 0, 2 * Math.PI);
                ctx.strokeStyle = "blue";
                ctx.fillStyle = 'red';
                ctx.fill();
                ctx.stroke();
                hasCircle = true;
            } else {
                $("#prodLat").text(Lat);
                $("#prodLon").text(Lon);
                ctx.lineWidth = '3';
                ctx.strokeStyle = "red";
                ctx.moveTo(lastLat, lastLon);
                ctx.lineTo(Lat, Lon);
                ctx.stroke();
                lastLat = Lat;
                lastLon = Lon;
            }
        });
        });

        var interval = setInterval(myTimer, IntervalTime);
    

    </script>
</body>



